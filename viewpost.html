<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>View Post</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .loading, .error, .post { font-size: 1.2em; }
    .error { color: red; }
    img { max-width: 100%; height: auto; margin-top: 10px; }
  </style>
</head>
<body>
  <div id="root" class="loading">Loading post...</div>

  <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-database.js"></script>

  <script>
    // Your Firebase config here
    const firebaseConfig = {
      apiKey: "AIzaSyDFHskUWiyHhZke3KT9kkOtFI_gPsKfiGo",
      authDomain: "itzhoyoo-f9f7e.firebaseapp.com",
      databaseURL: "https://itzhoyoo-f9f7e-default-rtdb.firebaseio.com",
      projectId: "itzhoyoo-f9f7e",
      storageBucket: "itzhoyoo-f9f7e.filestorage.app",
      messagingSenderId: "1094792075584",
      appId: "1:1094792075584:web:d49e9c3f899d3cd31082a5",
      measurementId: "G-LLT6F9WRKH"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const root = document.getElementById('root');

    function getPostId() {
      const params = new URLSearchParams(window.location.search);
      return params.get('postId');
    }

    function escapeHTML(text) {
      if (!text) return '';
      return text.replace(/[&<>"']/g, (match) => {
        const escape = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' };
        return escape[match];
      });
    }

    async function loadPost() {
      const postId = getPostId();
      if (!postId) {
        root.className = 'error';
        root.textContent = 'No post ID in URL.';
        return;
      }

      root.className = 'loading';
      root.textContent = 'Loading post...';

      try {
        const snapshot = await db.ref('post/' + postId).get();
        if (!snapshot.exists()) {
          root.className = 'error';
          root.textContent = 'Post not found.';
          return;
        }
        const post = snapshot.val();
        root.className = 'post';
        root.innerHTML = `
          <h1>${escapeHTML(post.title)}</h1>
          ${post.imageUrl ? `<img src="${escapeHTML(post.imageUrl)}" alt="Post Image" />` : ''}
          <p>${escapeHTML(post.description)}</p>
        `;
      } catch (e) {
        root.className = 'error';
        root.textContent = 'Error loading post.';
        console.error(e);
      }
    }

    loadPost();
  </script>
</body>
</html>