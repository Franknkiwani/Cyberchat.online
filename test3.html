<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CyberChat Ads - Pro Dashboard</title>
  <style>
    /* Reset & base */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      background: #001f22;
      color: #00e5ff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }
    header {
      background: #002c2f;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      border-bottom: 2px solid #00e5ff;
    }
    .logo {
      font-weight: 900;
      font-size: 1.6rem;
      letter-spacing: 3px;
      user-select: none;
    }
    .header-actions {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }
    .balance-btn {
      background: #00e676;
      color: #001f22;
      font-weight: 700;
      padding: 0.5rem 1.2rem;
      border: none;
      border-radius: 12px;
      cursor: default;
      user-select: none;
      box-shadow: 0 0 8px #00e676aa;
      transition: background 0.3s ease;
    }
    .balance-btn:hover {
      background: #00c853;
      box-shadow: 0 0 12px #00c853cc;
    }
    /* Hamburger */
    .hamburger {
      width: 44px;
      height: 36px;
      position: relative;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      user-select: none;
    }
    .hamburger span {
      display: block;
      height: 5px;
      border-radius: 3px;
      background: #00e5ff;
      transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    }
    .hamburger span:nth-child(1) {
      width: 100%;
    }
    .hamburger span:nth-child(2) {
      width: 70%;
      align-self: flex-start;
    }
    .hamburger span:nth-child(3) {
      width: 50%;
      align-self: flex-end;
    }
    .hamburger.active span:nth-child(1) {
      transform: translateY(13px) rotate(45deg);
      width: 50%;
      align-self: center;
    }
    .hamburger.active span:nth-child(2) {
      opacity: 0;
    }
    .hamburger.active span:nth-child(3) {
      transform: translateY(-13px) rotate(-45deg);
      width: 50%;
      align-self: center;
    }

    main {
      flex: 1;
      background: #00383b;
      padding: 2rem;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .chart-container {
      position: relative;
      width: 95%;
      max-width: 900px;
      height: 420px;
      background: #005358;
      border-radius: 20px;
      box-shadow: 0 0 25px #00e5ff88;
      padding: 1rem 1.5rem;
      user-select: none;
    }
    canvas {
      display: block;
      width: 100% !important;
      height: 100% !important;
      border-radius: 16px;
      background: #002f32;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo" aria-label="CyberChat Ads Logo">CYBERCHAT ADS</div>
    <div class="header-actions">
      <button class="balance-btn" aria-label="Ad balance">$0.000</button>
      <div class="hamburger" role="button" aria-label="Toggle menu" tabindex="0">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </header>

  <main>
    <section class="chart-container" aria-label="Ad performance chart">
      <canvas id="adsChart" role="img" aria-describedby="chartDesc"></canvas>
      <div id="chartDesc" style="position:absolute; left:-9999px; height:1px; width:1px; overflow:hidden;">
        Line chart showing daily ad views and ad clicks.
      </div>
    </section>
  </main>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-database.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDFHskUWiyHhZke3KT9kkOtFI_gPsKfiGo",
      authDomain: "itzhoyoo-f9f7e.firebaseapp.com",
      databaseURL: "https://itzhoyoo-f9f7e-default-rtdb.firebaseio.com",
      projectId: "itzhoyoo-f9f7e",
      storageBucket: "itzhoyoo-f9f7e.filestorage.app",
      messagingSenderId: "1094792075584",
      appId: "1:1094792075584:web:d49e9c3f899d3cd31082a5",
      measurementId: "G-LLT6F9WRKH"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Hamburger toggle
    const hamburger = document.querySelector('.hamburger');
    hamburger.addEventListener('click', () => {
      hamburger.classList.toggle('active');
      // Sidebar logic can go here
    });
    hamburger.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        hamburger.click();
      }
    });

    const ctx = document.getElementById('adsChart').getContext('2d');

    const adsChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [
          {
            label: 'Ad Views',
            data: [],
            borderColor: '#00e676',
            backgroundColor: 'rgba(0, 230, 118, 0.3)',
            fill: true,
            tension: 0.25,
            pointRadius: 6,
            pointHoverRadius: 8,
            borderWidth: 3,
          },
          {
            label: 'Ad Clicks',
            data: [],
            borderColor: '#00bfa5',
            backgroundColor: 'rgba(0, 191, 165, 0.3)',
            fill: true,
            tension: 0.25,
            pointRadius: 6,
            pointHoverRadius: 8,
            borderWidth: 3,
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            labels: {
              color: '#00e5ff',
              font: {
                weight: '600',
                size: 14
              }
            }
          },
          tooltip: {
            mode: 'nearest',
            intersect: false,
            backgroundColor: '#00e5ff',
            titleColor: '#001f22',
            bodyColor: '#001f22',
            cornerRadius: 8,
            padding: 10,
            displayColors: false,
            bodyFont: {weight: '600'}
          }
        },
        scales: {
          x: {
            ticks: {
              color: '#00e5ff',
              font: { weight: '600' },
              maxRotation: 0,
              minRotation: 0,
            },
            grid: {
              color: 'rgba(0, 255, 255, 0.15)',
              borderColor: '#00e5ff'
            }
          },
          y: {
            beginAtZero: true,
            ticks: {
              color: '#00e5ff',
              font: { weight: '600' },
              stepSize: 20
            },
            grid: {
              color: 'rgba(0, 255, 255, 0.15)',
              borderColor: '#00e5ff',
              drawBorder: true
            }
          }
        }
      }
    });

    // Show No Data text on empty canvas
    function drawNoDataText() {
      const width = adsChart.width;
      const height = adsChart.height;
      const ctx = adsChart.ctx;
      ctx.clearRect(0, 0, width, height);
      ctx.font = 'bold 28px Segoe UI, Arial';
      ctx.fillStyle = '#00e5ff';
      ctx.textAlign = 'center';
      ctx.fillText('No Data', width / 2, height / 2);
    }

    // Fetch and update data
    function updateChartWithFirebaseData() {
      const statsRef = db.ref('adsStats');

      statsRef.on('value', (snapshot) => {
        const data = snapshot.val();

        if (!data || Object.keys(data).length === 0) {
          adsChart.data.labels = [];
          adsChart.data.datasets.forEach(dataset => dataset.data = []);
          adsChart.update();
          drawNoDataText();
          document.querySelector('.balance-btn').textContent = '$0.000';
          return;
        }

        const dates = Object.keys(data).sort();
        const views = [];
        const clicks = [];

        dates.forEach(date => {
          views.push(data[date].views || 0);
          clicks.push(data[date].clicks || 0);
        });

        adsChart.data.labels = dates;
        adsChart.data.datasets[0].data = views;
        adsChart.data.datasets[1].data = clicks;
        adsChart.update();

        // Calculate total clicks for balance (example)
        const totalClicks = clicks.reduce((a, b) => a + b, 0);
        // Example: assume each click = $0.01
        const balance = totalClicks * 0.01;
        document.querySelector('.balance-btn').textContent = `$${balance.toFixed(3)}`;
      }, (error) => {
        // On error, clear chart & show no data
        adsChart.data.labels = [];
        adsChart.data.datasets.forEach(ds => ds.data = []);
        adsChart.update();
        drawNoDataText();
        document.querySelector('.balance-btn').textContent = '$0.000';
        console.error('Firebase data error:', error);
      });
    }

    updateChartWithFirebaseData();
  </script>
</body>
</html>